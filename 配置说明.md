# Tushare MCP Server - 快速配置指南

## 📋 前提条件

1. ✅ 已安装 Python 3.8+
2. ✅ 已安装项目依赖：`pip install -r requirements.txt`
3. ✅ 已配置 TUSHARE_TOKEN（在项目根目录的 `.env` 文件中）

## 🚀 快速配置步骤

### 步骤 1: 确认 Token 已配置

在项目根目录检查 `.env` 文件是否存在并包含您的 token：

```env
TUSHARE_TOKEN=your_actual_token_here
```

### 步骤 2: 运行自动配置脚本

在项目根目录打开 PowerShell，运行：

```powershell
.\setup_claude_config.ps1
```

如果遇到执行策略限制，先运行：

```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### 步骤 3: 重启 Claude Desktop

1. 完全关闭 Claude Desktop 应用（确保所有窗口都关闭）
2. 重新启动 Claude Desktop

### 步骤 4: 验证配置

在 Claude Desktop 中尝试以下命令：

1. **检查 Token 状态**
   ```
   请检查 token 状态
   ```

2. **查询股票信息**
   ```
   查询平安银行(000001.SZ)的基本信息
   ```

3. **搜索股票**
   ```
   搜索包含"新能源"的股票
   ```

## 🔧 手动配置（如果自动脚本失败）

### 配置文件位置

Windows: `%APPDATA%\Claude\claude_desktop_config.json`

完整路径示例：
```
C:\Users\你的用户名\AppData\Roaming\Claude\claude_desktop_config.json
```

### 配置内容

```json
{
  "mcpServers": {
    "tushare": {
      "command": "python",
      "args": [
        "G:\\AICode\\tocker-mcp\\tushare_MCP\\server.py"
      ]
    }
  }
}
```

**重要：**
- 将路径中的 `G:\\AICode\\tocker-mcp\\tushare_MCP\\server.py` 替换为您的实际项目路径
- Windows 路径中的反斜杠需要转义为 `\\`

## ❓ 常见问题

### Q1: 提示找不到 Python

**解决方案：**
- 确保 Python 已添加到系统 PATH
- 或在配置中使用 Python 的完整路径

### Q2: Claude 中看不到 Tushare 工具

**检查清单：**
1. ✅ 配置文件路径正确
2. ✅ JSON 格式正确（无语法错误）
3. ✅ 已完全重启 Claude Desktop
4. ✅ `.env` 文件存在且包含有效的 token
5. ✅ Python 和依赖已正确安装

### Q3: Token 配置失败

**解决方案：**
1. 检查 `.env` 文件格式是否正确
2. 确认 token 有效（访问 https://tushare.pro/user/token 验证）
3. 尝试使用 `setup_tushare_token` 工具重新配置

### Q4: 执行策略限制（PowerShell）

**解决方案：**
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

## 📞 获取帮助

如果遇到问题，请检查：
1. Claude Desktop 的日志文件
2. 项目根目录是否有 `.env` 文件
3. Python 环境是否正确

